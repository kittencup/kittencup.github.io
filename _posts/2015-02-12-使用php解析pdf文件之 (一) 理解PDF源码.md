---
layout: post
title: "使用php解析pdf文件之 (一) 理解PDF源码"
date: 2015-02-12
categories: php
---


本文主要讲解PDF文件源码语法，理解PDF文件源码格式才能正确的解析PDF文件

## 2.源码内容

```bash
%PDF-1.3 %Äåòåë§ó ÐÄÆ 4 0 obj << /Length 5 0 R /Filter /FlateDecode >> stream xM Â0…÷=Åwí$mjâB
........
endobj xref 0 75 0000000000 65535 f 0000230284 00000 n 0000000253 00000 n 0000214387 00000 n 0000000022 00000 n 0000000234 00000 n 0000000358 00000 n 0000004450 00000 n 0000003201 00000 n 0000214556 00000 n 0000000465 00000 n 0000003180 00000 n 0000003237 00000 n 0000004429 00000 n 0000004858 00000 n
........
trailer << /Size 75 /Root 50 0 R /Info 1 0 R /ID [ ] >> startxref 230428 %%EOF
```

3.PDF文件的基本组成：
------

1.  文件头 header，指明了该文件所遵从的PDF规范的版本号，它出现在PDF文件的第一行。
    > %PDF-1.3
2.  文件体，PDF文件的主要部分，由一系列对象组成。    > obj << /Length 5 0 R /Filter /FlateDecode >> stream xM Â0…÷=Åwí....... endobj
3.  交叉引用表，为了能对间接对象进行随机存取而设立的一个间接对象的地址索引表
    > xref 0 75 0000000000 65535 f 0000230284 00000 n ..... 0000230264 00000
4.  文件尾，声明了交叉引用表的地址，指明了文件体的根对象（Catalog）等。    > trailer << /Size 75 /Root 50 0 R /Info 1 0 R /ID [ ] >> startxref 230428

    ## 4.文件尾 Trailer：

*   /Root 50 0 R 表示文档的根节点（Catalog) 它指向了一个对象，这个对象的编号是 50 0
*   startxref 230428 表示该文档中交叉引用表偏移地址，可以这样理解从PDF源码开始第230428个字节就是交叉引用表的开始

    ## 5.交叉引用表:

*   xref的开始说明了是一个交叉引用表
*   0 75 交叉引用表里所描述的对象编号是从0开始，一共有75个对象
*   0000000000 65535 f 对象0的起始地址为0000000000，最大产生号65535，f表示未使用
*   0000230284 00000 n 对象的偏移地址为230284，0表明该对象未被修改过, n表示该对象在使用

    ## 6.文件体

*   每一个对象由obj ... endobj包含
*   (hello world) 或者 16进制<4E6F762073686D6F7A206B6120706F702E> 表示为字符串对象
*   /Type “/”开始的表示为名称对象,并不是为了显示一段文本，在这表示对象的类型
*   []表示为数组对象，可以是任何元素组成，可以嵌套 [[]]
*   <<>>表示为字典对象，字典的每个条目，它的第一个元素是“键”，第二个元素是“值”，可以嵌套
*   stream ... end stream 流对象，流对象是一个字节序列，流对象没有长度限制，而字符串会受到限制。包含大量数据的对象（图像或者页面描述）会表示为流
*   NULL对象，类型和值不等于任何其他对象，使用关键字null表示，如果引用了一个不存在的对象，就视同为引用了一个null对象。
*   间接对象(objref)，PDF文件中的任何对象都可以标记为间接对象，它为对象提供了唯一的标识符，其他对象可以通过它来引用该对象
*   布尔对象 布尔对象表示真和假的逻辑值，它们在PDF文件中显示为关键字true和false
*   数字对象 PDF提供了两种类型的数字对象：整数和实数

    ## 7.简单分析一个obj

    <pre>`1 0 obj << /Type /Pages /Kids[2 0 R] /Count 1>> endobj
    2 0 obj
    <<
    /Type
    /Page
    /Parent 1 0 R
    /MediaBox [0 0 612 792]
    /Contents 4 0 R
    /Resources <<
                /Font << /Font1 5 0 R >>
                      << /XObject << /Image1 6 0 R>> >>
                >>
    >>
    endobj

第一个编号为1 0的obj,类型是页面树，它的子节点是编号为2 0的对象，页码总数是1
第二个编号为2 0的obj,类型是页面，它的父亲是编号为1 0的对象，页面的大小未612*792,内容在编号为4 0的对象，它有2个资源，1个是字体在编号为5 0的对象,另个是图片编号为6 0的对象