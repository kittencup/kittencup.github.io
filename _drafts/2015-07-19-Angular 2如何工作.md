---
layout: post
title: "Angular 2如何工作"
date: 2015-07-19
categories: javascript
---

(Angular 如何工作)How Angular Works
------

在本章，我们将讨论Angular 2中得高级概念，我们的想法是，通过采取退后一步，我们可以看到所有的组件如何相互配合。

如果你有使用过Angular 1,您会注意到Angular 2以一个新的思维模式来构建应用程序。别慌!对于Angular 1用户来讲Angular 2既简单和熟悉。在下一章,我们将专门讨论如何转换应用程序从Angular 1到Angular 2

在后面的章节中,我们将深入了解每个概念,但在这里我们只是要给概述和解释的基本思想。

第一个大的思想是一个Angular 2应用程序由组件构成。组件的一种方式是教浏览器来认识新标签，如果你有Angular 1的使用背景,组件是类似于Angular 1指令(事实证明,Angular 2也有指令,但是以后我们会进一步讨论这个区别)。

然而 Angular 2组件相对于Angular 1指令有一些显著的优势。我们将在下面讨论。首先，让我们从头开始：应用(application)。

(应用)Application
------

Angular 2应用程序只不过是一个是组件树。

在树的根部，最顶层的组件就是应用的本身，这就是浏览器将引导的(boostrap)的应用

其中一个有关组件的大事是，他们是可组合。这意味着，我们可以从较小组件来建立更大的组件。应用程序只是一个简单的渲染其他组件的组件。

因为组件是一个父/子树的结构,每个组件呈现时,递归地呈现其子组件。

例如,让我们来讨论一个虚构的库存管理应用程序，下面是它的页面模型:

![](/images/2015-07-19-Angular 2如何工作/a.png)

鉴于这种模型,编写这个应用程序我们要做的第一件事就是把它分成单个组件(组织成一个树)。在这个例子中,我们可以组页面分成三个相同级别的组件

* 导航组件
* 面包屑组件
* 产品列表组件

导航组件 该组件将渲染导航部分。这将允许用户访问应用程序的其他页面

![](/images/2015-07-19-Angular 2如何工作/b.png)

面包屑组件 这将渲染表示应用程序中的用户目前在哪里。

![](/images/2015-07-19-Angular 2如何工作/c.png)

产品列表组件 这将是一个表示产品的集合。

![](/images/2015-07-19-Angular 2如何工作/d.png)

把这个组件分解成更小的下一个级别组件,我们可以说,产品列表组件是有多个产品列组成的

![](/images/2015-07-19-Angular 2如何工作/e.png)

当然,我们可以继续更进一步,将每个产品行分解成更小的片段:

* 产品图片(Product Image)组件，这将是负责渲染产品图片，获取图片名字(例如,组件知道如何使用适当的Amazon S3的URL来获取图像）
* 产品分类(Product Department)组件，给定一个产品分类id，来渲染分类树，类似于 Men > Shoes > Running Shoes
* 显示价格(Price Display)将是一个更通用的组件,跨越应用程序时,可以再次利用,是用来正确呈现一个价格。想象我们的实现定制的定价如果用户已经登录了则包括折扣或运费等。在这个组件我们可以实现所有这些行为。
                       
最后，把它全部连成一个树表示，我们最终得到如下图：
  
![](/images/2015-07-19-Angular 2如何工作/f.png)

在顶部，我们看到库存管理app：这是我们的应用程序(用来bootstrap)。

根据应用程序，我们有导航，面包屑和产品列表的组件。需要注意的重要一点是，每个应用程序只能有一个顶级组件。

组件(Components)
------

正如你所看到的，组件是Angular 2应用基本构建块。我们把应用程序划分为更细粒度的子组件。

我们将使用他们,所以值得更仔细地看着他们。每个组件都是由三部分组成:

* 组件 装饰者(Decorator)
* 视图
* 控制器

![](/images/2015-07-19-Angular 2如何工作/g.png)

该产品列表组件的实现可能是：

```javascript
// 组件 装饰者(Decorator)
@Component({
  selector: 'products-list',
  properties: ['products']
})
// 视图注释(Annotation)
@View({
  directives: [ProductRow, NgFor], 
  template: `
    <div class="products-list">
      <div product-row *ng-for="#product in products" [product]="product"> </div>
    </div>
  `
})
// 控制器
class ProductsList { 
  products: Array<Product>;
}
```

如果你一直使用Angular 1的语法则看起来很奇怪!但思想很相似,所以让我们一步一步来看他们:

组件装饰和视图定义部分为注释,但是控制器是一个由一个类来表示。

如果你不知道注释(Annotations),可以通过这篇文章[https://github.com/Microsoft/TypeScript/issues/1557](https://github.com/Microsoft/TypeScript/issues/1557)来了解

现在让我们来看看每个部分详细内容。

组件装饰者(Component Decorator)
------

组件装饰者是你声明在组件外部如何将你的组件进行交互。

有许多可用的选项配置组件,我们将在组件这章组件详细了解。这里我们涉及的一些基础知识。


#### 组件选择器(Component selector)

选择器(selector)键值,表明你的组件将渲染的HTML标签。这个想法是类似于CSS或XPath选择器。选择器将HTML元素将匹配该组件。
在这种情况下, `selector:'products-list'`, 在我们的HTML，我们要匹配products-list标签，也就是说每当我们使用它,那么一个新的标签就被定义了新的内置功能，例如,当我们使用这个HTML时

```html
<products-list></products-list>
```

Angular 将使用ProductsList组件来实现功能。

另外,有了这个选择器,我们也可以使用常规的div,指定的组件将作为一个属性:

```html
<div products-list></div>
```

#### 组件属性(Component Properties)

@Component注释还有另一个键:properties,properties为我们描述我们期望组件的可配置参数。在这里当组件在渲染时，我们应该将一个产品数组传递给这个组件。

声明的所有组件从properties键接收参数。

